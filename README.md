# HierVS: a fully AI-driven hierarchical virtual screening module.

![](https://github.com/shukai1997/HierVS/blob/main/func4.jpeg)


## Introduction

HierVS is a fully AI-driven hierarchical virtual screening module. HierVS first employs KarmaDock for efficient docking, followed by CarsiDock for accurate docking and RTMscore for re-scoring. HierVS facilitates straightforward local deployment and execution, with dynamically adjustable virtual screening duration based on the  setting of precise-docked molecular quantities.

## System Requirements

| Component | Specification |
|-----------|---------------|
| **Operating System** | Ubuntu 22.04.5 |
| **Processor** | Intel(R) Core(TM) i9-14900KF |
| **GPU** | NVIDIA GeForce RTX 4090 |
| **Storage** | Minimum 24 GB of available hard-disk space |
| **CUDA** | Version 12.4 |
| **NVIDIA GPU Driver** | Version 550.144.03 |
| **Docker** | Version 28.0.1 |
| **Package Management** | PyPI (Python package management tool) |

*The software and hardware listed above are recommended, as our testing was conducted in this environment. Other software or hardware configurations may also be capable of running this tool properly.*


*In addition to the System Requirements mentioned aboved, Ubuntu24.04 and Ubuntu20.04, CUDA	Version 12.8 cooperated with NVIDIA GPU DriverVersion 570.133.07 and CUDA Version 11.4 cooperated with NVIDIA GPU Driver Version 470.82.01 have been verified and confirmed to work without issues.*

## Installation

###  Step 1: Download Docker Image
*(Download time depends on your network speed)*


**Hugging Face:**
```
wget https://huggingface.co/gushukai/HierVS/resolve/main/hier_vs_v9.tar
```

###  Step 2: Deploy the docker image
*(Takes several seconds to minutes)*
```
docker load -i hier_vs_v9.tar
```

###  Step 3: Install HierVS package
*(Takes several seconds )*
```
pip install HierVS
```


## Conducting hierarchical Virtual screening

### Virtual screening can be performed using HierVS with the following command:

```
HierVS -p protein_file -l ligand_file -cl compound_library_file -o output_path -n TopN -v IMAGE_VERSION
```



-p protein_file: Path to the protein structure file (PDB format)

-l ligand_file: Path to the reference ligand file (SDF or MOL2 format)

-cl compound_library_file: Path to the compound library file (TXT format)

-o output_path: Path to the output directory

-n TopN: Number of top molecules for CarsiDock and RTMScore

-v IMAGE_VERSION: Docker image version (default: hier_vs:v9)


> **üìù Note: Important Advisory on RDKit Version**
> 
> In the CarsiDock molecular docking pipeline, a known issue in specific versions of RDKit can, on rare occasions, cause a segmentation fault during the generation of initial molecular conformations. This may lead to unexpected termination of the screening task.
> 
> **Recommended Solution**: If you encounter this error, please switch the Docker image to **`hier_vs:v9b`**. This version contains an upgraded RDKit installation that specifically resolves this stability issue. Prior to use, first download and deploy the image using wget https://huggingface.co/gushukai/HierVS/resolve/main/hier_vs_v9b.tar and docker load -i hier_vs_v9b.tar.
> 
> ‚ö†Ô∏è **Key Change**: `hier_vs:v9` ‚Üí **`hier_vs:v9b`**

### Example:
```
HierVS -p ./examples/example_protein.pdb -l ./examples/example_ligand.sdf -cl ./examples/example_compound_library.txt -o ./examples/result -n 50 -v hier_vs:v9
```


### Expected results:
karmadock_prediction.csv: Contains KarmaDock prediction results

carsidock_prediction.csv: Contains RTMScore rescoring results based on CarsiDock-based docking poses

*.sdf files: Ligand poses generated by CarsiDock

