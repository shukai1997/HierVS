# HierVS: a fully AI-driven hierarchical virtual screening module.

![](https://github.com/shukai1997/HierVS/blob/main/func4.jpeg)


## Introduction

HierVS is a fully AI-driven hierarchical virtual screening module. HierVS first employs KarmaDock for efficient docking, followed by CarsiDock for accurate docking and RTMscore for re-scoring. HierVS facilitates straightforward local deployment and execution, with dynamically adjustable virtual screening duration based on the  setting of precise-docked molecular quantities.

## System Requirements

| Component | Specification |
|-----------|---------------|
| **Operating System** | Ubuntu 22.04.5 |
| **Processor** | Intel(R) Core(TM) i9-14900KF |
| **GPU** | NVIDIA GeForce RTX 4090 |
| **Storage** | Minimum 24 GB of available hard-disk space |
| **CUDA** | Version 12.4 |
| **NVIDIA GPU Driver** | Version 550.144.03 |
| **Docker** | Version 28.0.1 |
| **Package Management** | PyPI (Python package management tool) |

*The software and hardware listed above are recommended, as our testing was conducted in this environment. Other software or hardware configurations may also be capable of running this tool properly.*

## Installation

###  Step 1: Download Docker Image
*(Download time depends on your network speed)*

Choose one of the following download sources:

**Option A - Hugging Face:**
```
wget https://huggingface.co/gushukai/HierVS/resolve/main/hier_vs_v9.tar.gz
```
**Option B - Zenodo:**
```
wget https://zenodo.org/records/15860229/files/hier_vs_v9.tar.gz
```


###  Step 2: Deploy the docker image
*(Takes several seconds to minutes)*
```
gunzip -c hier_vs_v9.tar.gz | docker load
```

###  Step 3: Install HierVS package
*(Takes several seconds )*
```
pip install HierVS
```


## Conducting hierarchical Virtual screening

### Virtual screening can be performed using HierVS with the following command:

```
HierVS -p protein_file -l ligand_file -cl compound_library_file -o output_path -n TopN -v IMAGE_VERSION
```



-p protein_file: Path to the protein structure file (PDB format)

-l ligand_file: Path to the reference ligand file (SDF or MOL2 format)

-cl compound_library_file: Path to the compound library file (TXT format)

-o output_path: Path to the output directory

-n TopN: Number of top molecules for CarsiDock and RTMScore

-v IMAGE_VERSION: Docker image version (default: hier_vs:v9)

### Example:
```
HierVS -p ./examples/example_protein.pdb -l ./examples/example_ligand.sdf -cl ./examples/example_compound_library.txt -o ./examples/result -n 50 -v hier_vs:v9
```

### Expected results:
karmadock_prediction.csv: Contains KarmaDock prediction results

carsidock_prediction.csv: Contains RTMScore rescoring results based on CarsiDock docking conformations

*.sdf files: Docking conformations generated by CarsiDock

